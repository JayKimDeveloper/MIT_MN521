---
# main.yml - ë©€í‹°í…Œë„ŒíŠ¸ ë„¤íŠ¸ì›Œí¬ ìë™í™” ë©”ì¸ ì‹¤í–‰ íŒŒì¼
- name: "===== ë©€í‹°í…Œë„ŒíŠ¸ ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ ë°°í¬ ì‹œì‘ ====="
  hosts: localhost
  gather_facts: no
  tasks:
    - name: ë°°í¬ ì‹œì‘ ì•Œë¦¼
      debug:
        msg: |
          ========================================
          ë©€í‹°í…Œë„ŒíŠ¸ ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ ìë™ ë°°í¬
          ========================================
          
          ë°°í¬ ëŒ€ìƒ:
          - CustomerA (dist1): VLAN 100-109
          - CustomerB (dist1): VLAN 200-209  
          - CustomerC (dist2): VLAN 300-309
          
          êµ¬ì„± ìŠ¤ìœ„ì¹˜:
          - Distribution: dist1-sw, dist2-sw
          - Access: access-sw1~4
          
          ë°°í¬ ìˆœì„œ:
          1. Distribution Layer ì„¤ì •
          2. Access Layer ì„¤ì •
          ========================================

- name: "1ë‹¨ê³„: Distribution Layer ë°°í¬"
  import_playbook: distribution.yml

- name: "2ë‹¨ê³„: Access Layer ë°°í¬"  
  import_playbook: access.yml

- name: "===== ë°°í¬ ì™„ë£Œ ë° ìš”ì•½ ====="
  hosts: localhost
  gather_facts: no
  vars_files:
    - vars/customers.yml
  tasks:
    - name: ë°°í¬ ì™„ë£Œ ìš”ì•½
      debug:
        msg: |
          ========================================
          ğŸ‰ ë©€í‹°í…Œë„ŒíŠ¸ ë„¤íŠ¸ì›Œí¬ ë°°í¬ ì™„ë£Œ! ğŸ‰
          ========================================
          
          ë°°í¬ëœ ê³ ê°ì‚¬:
          {% for customer in customers %}
          ğŸ“‹ {{ customer.name }} ({{ customer.location }})
             â”œâ”€â”€ ì„œë²„ VLAN: {{ customer.vlans.web }}(Web), {{ customer.vlans.app }}(App), {{ customer.vlans.db }}(DB)
             â”œâ”€â”€ ì‚¬ìš©ì VLAN: {{ customer.vlans.users }}
             â”œâ”€â”€ ì„œë²„ ìˆ˜: {{ customer.servers | length }}ëŒ€
             â”œâ”€â”€ ì§ì› ìˆ˜: {{ customer.users | length }}ëª…
             â””â”€â”€ ë„¤íŠ¸ì›Œí¬: {{ customer.networks.web.split('.')[0] }}.{{ customer.networks.web.split('.')[1] }}.x.x
          {% endfor %}
          
          ğŸ”§ í…ŒìŠ¤íŠ¸ ë°©ë²•:
          1. PCì—ì„œ ê²Œì´íŠ¸ì›¨ì´ ping í…ŒìŠ¤íŠ¸
          2. ë™ì¼ VLAN ë‚´ PC ê°„ í†µì‹  í™•ì¸
          3. ë‹¤ë¥¸ ê³ ê° ê°„ ê²©ë¦¬ í™•ì¸
          
          ğŸš€ í™•ì¥ ë°©ë²•:
          - vars/customers.ymlì—ì„œ servers/users ë¦¬ìŠ¤íŠ¸ì— PC ì¶”ê°€
          - ansible-playbook -i inventory/hosts.ini main.yml ì¬ì‹¤í–‰
          
          ========================================
          
